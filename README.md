# Stable Diffusion API Client

## 概要

Stable Diffusion WebUIのAPIを利用したクライアントアプリです。WebUIの以下のような不満を解消するために作りました

- 全体的に挙動が緩慢
- 大量にタブを開くとメモリ消費量が増える
- ブラウザやPC再起動で作業中の設定が全て消える
- 複数タブの生成設定をまとめて修正したりするのが大変

自分のために作ったものを公開してるだけなので、足りない機能とかも色々あります

## 機能

-   **タブデータの保存**
    -   タブデータは保存されるので、アプリを閉じても次回起動時に自動で復元されます
-   **二重タブ構造**:
    -   外側タブと内側タブの二重構造により、複数の画像生成設定を整理できます。外側タブがブラウザの別ウィンドウに相当し、内側タブがブラウザのタブに相当します
    -   タブの複製、外側タブのタイトル編集、ドラッグ＆ドロップによる並べ替えに対応しています。
    -   閉じたタブもブラウザのタブ復元機能のようにある程度まで復元可能です
-   **メモリ使用量の最適化** 
    - タブをいくつ開いてもメモリ消費量はあまり変わらないようにしてあります。現在見ているタブの画像だけをロードしているので、他のタブにいくつ画像があってもほぼ影響がありません
-   **ショートカットキー**: 
    -   全般
        -   **Ctrl/Shift + Enter**: 画像生成
    -   タブ関連
        -   **Ctrl + T**: 新しいタブを右側に開く(最後の生成設定を使用)
        -   **Ctrl + Shift + T**: 最後に閉じたタブを復元
        -   **Ctrl + R**: 現在の内側タブの設定を右側に複製
        -   **Ctrl + Shift + R**: 現在の内側タブの設定を左側に複製
        -   **Ctrl + W**: 現在の内側タブを閉じる
        -   **Ctrl + Tab / Alt + D**: 右のタブに移動
        -   **Ctrl + Shift + Tab / Alt + A**: 左のタブに移動
    -   エディタ
        -   **Ctrl + ↑↓**: プロンプト/LoRAの重み調整
        -   **Ctrl + -**: 重みに-1を掛ける(Negpip用)
        -   **Ctrl + D**: 現在のカーソル位置のタグを削除
        -   **Ctrl + F**: 検索パネルを表示
        -   **Esc**: 検索パネルを非表示
-   **オートコンプリート**
    -   普通のDanbooruタグに加え、スペースを考慮しないマッチングもします。"from behind"は"frombehi"と書けばマッチします
    -   単語のイニシャルによるマッチができます。例えばarms behind backは"abb"でマッチできます
-   **フォーマッティング**
    -   Ctrl+Sを押すか生成を開始した時にプロンプトが自動でフォーマットされます。連続したカンマやスペースの過不足が自動で修正され、見た目がすっきりします
-   **バルクインポート**
    -   複数画像をドラッグアンドドロップすると、一意なプロンプトだけを抽出して新しいタブで開きます
-   **画像エクスポート**
    -   外側タブの下のタブに現在表示されている画像をまとめてフォルダへエクスポートします。最後に生成したの満足行く画像だけを保存するのに便利です。外側タブを右クリックすると選択できます
    -   外側タブを閉じても後からエクスポートした画像をバルクインポートすればタブを復元できます

## 注意点
-   WebUi側のファイル保存形式がwebpであることを前提に作ってあります。jpgとかpngでも動くかもしれませんが、パフォーマンスが悪いと思います
-   作者が使いやすいと思う挙動に最適化されています。
-   WebUIのような拡張性はありません
